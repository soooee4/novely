<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Novel">
    <select id="getNovel">
        SELECT
            tcnm.complete_seqno,
            tcnm.complete_novel_title,
            tcnm.complete_novel_content,
            tcnm.like_count,
            tcnm.main_seqno,
            tcnm.sub_seqno,
            tcnm.main_author_id,
            tcnm.sub_author_id,
            tcnm.created_date,
            tcm.code_name as genre_1,
            tcm2.code_name as genre_2,
            tcm3.code_name as keyword_1,
            tcm4.code_name as keyword_2,
            tcm5.code_name as keyword_3,
            tcm6.color as genre_1_color,
            tcm7.color as genre_2_color,
            tcm8.color as keyword_1_color,
            tcm9.color as keyword_2_color,
            tcm10.color as keyword_3_color,
            tcnm.description 
        FROM
          t_complete_novel_mgt tcnm
        LEFT JOIN t_code_mgt tcm
          ON tcnm.genre_1 = tcm.code
        LEFT JOIN t_code_mgt tcm2
          ON tcnm.genre_2 = tcm2.code
        LEFT JOIN t_code_mgt tcm3
          ON tcnm.keyword_1 = tcm3.code
        LEFT JOIN t_code_mgt tcm4
          ON tcnm.keyword_2 = tcm4.code
        LEFT JOIN t_code_mgt tcm5
          ON tcnm.keyword_3 = tcm5.code
        LEFT JOIN t_code_mgt tcm6
          ON tcnm.genre_1 = tcm6.code
        LEFT JOIN t_code_mgt tcm7
          ON tcnm.genre_2 = tcm7.code
        LEFT JOIN t_code_mgt tcm8
          ON tcnm.keyword_1 = tcm8.code
        LEFT JOIN t_code_mgt tcm9
          ON tcnm.keyword_2 = tcm9.code
        LEFT JOIN t_code_mgt tcm10
          ON tcnm.keyword_3 = tcm10.code
        ORDER BY
            complete_seqno DESC           -- 오름차순 정렬:  ASC, 내림차순 정렬: DESC (최신글이 상단에 보이도록 하기 위해 내림차순 정렬)
    </select>

    <select id="getSubNovel">
        SELECT
            sub_novel_seqno,
            sub_title,
            sub_content,
            sub_like_count,
            main_novel_seqno
        FROM
            t_sub_novel_mgt
        WHERE
            main_novel_seqno = #{main_novel_seqno} 
        ORDER BY
            sub_novel_seqno DESC           -- 오름차순 정렬:  ASC, 내림차순 정렬: DESC (최신글이 상단에 보이도록 하기 위해 내림차순 정렬)
    </select>

    <select id="getMainNovel">
        SELECT
            title,
            content,
            created_user,
            created_date,
            main_description,
            novel_seqno,
            complete_yn
        FROM
            t_novel_mgt
        ORDER BY
            novel_seqno DESC           -- 오름차순 정렬:  ASC, 내림차순 정렬: DESC (최신글이 상단에 보이도록 하기 위해 내림차순 정렬)
    </select>

    <insert id="postNovel">
        INSERT INTO t_novel_mgt
        (
            title,
            content,
            created_user,
            genre_1,
            genre_2,
            keyword_1,
            keyword_2,
            keyword_3,
            description
        )
        VALUES 
        (
            #{title},
            #{content},
            #{created_user},
            #{genre_1},
            #{genre_2},
            #{keyword_1},
            #{keyword_2},
            #{keyword_3}
            #{description}
        )
    </insert>

 

</mapper>
